首先查看一下安全措施

![image-20200521151406290](https://static.hack1s.fun/images/2021/02/06/image-20200521151406290.png)

全都没开，毕竟是一道一分题，应该不会太难

运行一下的效果，一个输出一个输入然后结束

拖到IDA里面看一下

![image-20200521151712916](https://static.hack1s.fun/images/2021/02/06/image-20200521151712916.png)

几个输出之后最后调用了一个`gets`函数

前面输出的内容中输出了一个函数的地址

这个函数内容就是`cat flag`

![image-20200521151828614](https://static.hack1s.fun/images/2021/02/06/image-20200521151828614.png)

思路应该是差不多的，先填充v5到rbp的40h个字节

之后填充rbp，最后覆盖返回地址为WoW函数的地址

很奇怪的是，在本地运行的时候

```python
payload='a'*0x40+p64(0x40060d)
```

这样可以得到结果，而加了8个字节之后就不行了

但是远程的时候

```python
payload='a'*(0x40+0x8)+p64(0x40060d)
```

这样才能得到正确结果

怀疑是不是本地的虚拟机有点问题，可能是libc版本之类的

